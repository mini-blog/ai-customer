#!/bin/bash

echo "ğŸš€ å¯åŠ¨ç”µå•†å®¢æœæ™ºèƒ½ä½“ç³»ç»Ÿ..."

# æ£€æŸ¥Dockeræ˜¯å¦å®‰è£…
if ! command -v docker &> /dev/null; then
    echo "âŒ Dockeræœªå®‰è£…ï¼Œè¯·å…ˆå®‰è£…Docker"
    exit 1
fi

if ! command -v docker-compose &> /dev/null; then
    echo "âŒ Docker Composeæœªå®‰è£…ï¼Œè¯·å…ˆå®‰è£…Docker Compose"
    exit 1
fi

# æ£€æŸ¥.envæ–‡ä»¶
if [ ! -f ".env" ]; then
    echo "ğŸ“ åˆ›å»º.envæ–‡ä»¶..."
    cp nestjs-api/env.example .env
    echo "âœ… .envæ–‡ä»¶å·²åˆ›å»ºï¼Œè¯·æ ¹æ®éœ€è¦ä¿®æ”¹é…ç½®"
fi

# å¯åŠ¨æœåŠ¡
echo "ğŸ³ å¯åŠ¨DockeræœåŠ¡..."
docker-compose up -d

# ç­‰å¾…æœåŠ¡å¯åŠ¨
echo "â³ ç­‰å¾…æœåŠ¡å¯åŠ¨..."
sleep 30

# æ£€æŸ¥æœåŠ¡çŠ¶æ€
echo "ğŸ” æ£€æŸ¥æœåŠ¡çŠ¶æ€..."
docker-compose ps

echo ""
echo "âœ… ç³»ç»Ÿå¯åŠ¨å®Œæˆï¼"
echo ""
echo "ğŸ“± è®¿é—®åœ°å€ï¼š"
echo "   - åå°ç®¡ç†ï¼šhttp://localhost:3002"
echo "   - APIæ–‡æ¡£ï¼šhttp://localhost:3001/api-docs"
echo "   - é»˜è®¤ç®¡ç†å‘˜ï¼šadmin / password"
echo ""
echo "ğŸ“‹ å¸¸ç”¨å‘½ä»¤ï¼š"
echo "   - æŸ¥çœ‹æ—¥å¿—ï¼šdocker-compose logs -f"
echo "   - åœæ­¢æœåŠ¡ï¼šdocker-compose down"
echo "   - é‡å¯æœåŠ¡ï¼šdocker-compose restart"
echo "" 